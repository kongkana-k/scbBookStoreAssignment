package com.scb.assignment.bookStoreRestApi.utility;

import java.sql.Timestamp;
import java.time.LocalDateTime;

import com.scb.assignment.bookStoreRestApi.exception.InvalidParameterException;
import com.scb.assignment.bookStoreRestApi.exception.InvalidTokenException;
import com.scb.assignment.bookStoreRestApi.exception.TokenExpiredException;
import com.scb.assignment.bookStoreRestApi.model.User;

public class InputValidationUtility {
	public static void validateUser(User user) throws InvalidTokenException, TokenExpiredException {
		if (user == null) {
			throw new InvalidTokenException("invalid token.");
		}
		if (user.getTokenExpiredTime().before(Timestamp.valueOf(LocalDateTime.now()))) {
			throw new TokenExpiredException("token expired.");
		}
		user.setTokenExpiredTime(CryptographUtility.getNextExpiredTime());
	}
	
	public static void validateToken(String token) throws InvalidParameterException {
		if (token == null || token.equals("")) {
			throw new InvalidParameterException("invalid token.");
		}
	}
	
	public static void validateCreatUserRequest(CreateUserReq token) throws InvalidParameterException {
		if (userReq.getUsername() == null || userReq.getUsername().equals("")) {
			throw new InvalidParameterException("invalid username.");
		}
		if (userReq.getPassword() == null || userReq.getPassword().equals("")) {
			throw new InvalidParameterException("invalid password.");
		}
		if (userReq.getDateOfBirth() == null || userReq.getDateOfBirth().equals("")) {
			throw new InvalidParameterException("invalid date of birth.");
		}
	}
	

}
